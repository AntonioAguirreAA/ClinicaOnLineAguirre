<div class="solicitar-turno-container">
  <h3>Sacar Turno</h3>

  <div *ngIf="tipoUsuario === 'administrador'" class="pacientes">
    <label for="paciente">Seleccionar Paciente:</label>
    <select id="paciente" [(ngModel)]="pacienteSeleccionado">
      <option *ngFor="let paciente of pacientes" [ngValue]="paciente">
        {{ paciente.nombre }} {{ paciente.apellido }}
      </option>
    </select>
  </div>

  <!-- Mostrar Especialistas -->
  <ng-container *ngIf="step===1">
    <h4>Elegí una especialidad</h4>
    <div class="especialidades">
      <button *ngFor="let esp of especialidades"
              (click)="seleccionarEspecialidadGlobal(esp)"
              class="btn-cuadrado">
        <img [src]="esp.imgUrl" alt="{{esp.nombre}}"><p>{{esp.nombre}}</p>
      </button>
    </div>
  </ng-container>

  <!-- PASO 2 · especialistas ----------------------------------------- -->
  <ng-container *ngIf="step===2">
    <button class="btn-volver" (click)="volverA(1)">← Atrás</button>
    <h4>Especialistas que atienden {{especialidadSeleccionada}}</h4>
    
    <div class="especialistas">
      <div *ngFor="let esp of especialistasFiltrados" class="especialista-card">
        <p class="especialista-nombre">{{esp.nombre}} {{esp.apellido}}</p>
        <button (click)="seleccionarEspecialista(esp)" class="btn-redondo">
          <img [src]="esp.imagen" alt="{{esp.nombre}}">
        </button>
      </div>
    </div>
  </ng-container>

  <!-- PASO 3 · días --------------------------------------------------- -->
  <ng-container *ngIf="step===3">
    <button class="btn-volver" (click)="volverA(2)">← Atrás</button>
    <h4>Elegí un día</h4>
    <div class="dias-disponibles">
      <button *ngFor="let d of diasDisponibles"
              (click)="seleccionarDia(d)"
              [ngClass]="{active:d===diaSeleccionado}"
              class="btn-rectangular">{{d}}</button>
    </div>
  </ng-container>

  <!-- PASO 4 · horarios ---------------------------------------------- -->
  <ng-container *ngIf="step===4">
    <button class="btn-volver" (click)="volverA(3)">← Atrás</button>
    <h4>Elegí un horario</h4>
    <div class="horarios-disponibles">
      <button *ngFor="let h of horariosDisponibles"
              (click)="seleccionarHorario(h)"
              [disabled]="horariosReservados.has(h.split(' - ')[0])"
              [ngClass]="{
                active: h===horarioSeleccionado,
                ocupado: horariosReservados.has(h.split(' - ')[0])
              }"
              class="btn-horario">{{h}}</button>
    </div>

    <!-- confirmar ----------------------------------------------------- -->
    <div *ngIf="horarioSeleccionado" class="confirmar">
      <button class="btn-confirmar" (click)="confirmarTurno()">
        Confirmar Turno
      </button>
    </div>
  </ng-container>
</div>
